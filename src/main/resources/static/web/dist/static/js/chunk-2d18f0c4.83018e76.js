(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d18f0c4"],{"21c5":function(e,t,i){},7203:function(e,t,i){"use strict";i("bc2e")},"772c":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"serach"},[e._m(0),t("div",{staticClass:"login-out",attrs:{title:"退出"},on:{click:e.logout}}),t("div",{staticClass:"table-pannel"},[t("div",{staticClass:"btn-box"},[t("div",{staticStyle:{display:"flex"}},[t("div",{staticClass:"add-btn",on:{click:e.addDialog}},[t("div",{staticClass:"add-btn-bg"}),t("div",{staticClass:"add-btn-name"},[e._v("新增")])]),t("div",{staticClass:"del-btn",on:{click:e.delDialog}},[t("div",{staticClass:"del-btn-bg"}),t("div",{staticClass:"del-btn-name"},[e._v("删除")])]),t("div",{staticClass:"edit-btn",on:{click:function(t){e.roleTabShow="7"}}},[t("div",{staticClass:"edit-btn-bg"}),t("div",{staticClass:"edit-btn-name"},[e._v("角色")])])]),t("div",{staticStyle:{display:"flex"}},[t("div",{staticClass:"search-input"},[t("div",{staticClass:"search-name"},[e._v("权限名称：")]),t("el-input",{attrs:{placeholder:"请输入权限名称搜索",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchInputFun.apply(null,arguments)}},model:{value:e.qxName,callback:function(t){e.qxName=t},expression:"qxName"}})],1),t("div",{staticClass:"search-input"},[t("div",{staticClass:"search-name"},[e._v("URL路径：")]),t("el-input",{attrs:{placeholder:"请输入URL路径搜索",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchInputFun.apply(null,arguments)}},model:{value:e.qxUrl,callback:function(t){e.qxUrl=t},expression:"qxUrl"}})],1),t("div",{staticClass:"search-btn-input",on:{click:e.searchInputFun}},[t("i",{staticClass:"el-icon-search"})])])]),t("el-table",{ref:"multipleTable",staticClass:"table",staticStyle:{width:"100%","font-size":"18px"},attrs:{stripe:"",height:"calc(100% - 120px)",data:e.tableData,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange,"row-click":e.handleRowClick}},[t("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),t("el-table-column",{attrs:{prop:"urlName",label:"权限名称",align:"center",width:"180","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{prop:"url",label:"URL路径",align:"center"}}),t("el-table-column",{attrs:{prop:"open",label:"是否公开",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return["0"==i.row.open?t("span",[e._v(" 私有 ")]):"1"==i.row.open?t("span",[e._v(" 公开 ")]):t("span",[e._v(" 匿名 ")])]}}])}),t("el-table-column",{attrs:{prop:"description",label:"描述",align:"center",width:"280","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(i){return[null==i.row.description?t("span",[e._v(" -- ")]):t("span",[e._v(" "+e._s(i.row.description))])]}}])}),t("el-table-column",{attrs:{prop:"createTime",label:"创建时间",align:"center"}}),t("el-table-column",{attrs:{prop:"name",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("div",{staticClass:"table-operation"},[t("div",{on:{click:function(t){return t.stopPropagation(),e.handleEdit(i.$index,i.row)}}},[t("i",{staticClass:"el-icon-edit"}),e._v("   "),t("span",{staticStyle:{"font-size":"18px"}},[e._v("修改")])]),t("div",{on:{click:function(t){return t.stopPropagation(),e.handleDel(i.$index,i.row)}}},[t("i",{staticClass:"el-icon-delete"}),e._v("   "),t("span",{staticStyle:{"font-size":"18px"}},[e._v("删除")])])])]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.pageNum,background:"","page-size":e.pageSize,layout:"total, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.pageNum=t},"update:current-page":function(t){e.pageNum=t}}})],1)],1),t("el-dialog",{attrs:{title:e.title,visible:e.add,"before-close":e.handleClose,width:"600px","append-to-body":""},on:{"update:visible":function(t){e.add=t}}},[t("el-form",{ref:"form",attrs:{model:e.addForm,rules:e.addrules,"label-width":"80px"}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"权限名称",prop:"urlName"}},[t("el-input",{attrs:{placeholder:"请输入权限名称",clearable:""},model:{value:e.addForm.urlName,callback:function(t){e.$set(e.addForm,"urlName",t)},expression:"addForm.urlName"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"URL路径",prop:"url"}},[t("el-input",{attrs:{placeholder:"请输入URL路径",clearable:""},model:{value:e.addForm.url,callback:function(t){e.$set(e.addForm,"url",t)},expression:"addForm.url"}})],1)],1)],1),t("el-row",{staticClass:"special-row"},[t("el-col",{attrs:{span:24}},[t("el-form-item",{staticStyle:{"margin-bottom":"5px"},attrs:{label:"是否公开"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择是否公开",clearable:""},model:{value:e.addForm.open,callback:function(t){e.$set(e.addForm,"open",t)},expression:"addForm.open"}},e._l(e.dictOptions,(function(e){return t("el-option",{key:e.id.toString(),attrs:{label:e.dictName,value:e.dictVal}})})),1)],1),t("ul",{staticClass:"desc-list"},[t("li",[e._v(" 1、私有：登录后需要为角色分配权限 ")]),t("li",[e._v(" 2、公开：登录后无需为角色分配权限 ")]),t("li",[e._v(" 3、匿名：无需登录 ")])])],1)],1),t("el-row"),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"角色选择"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择角色",multiple:"",disabled:"1"==e.addForm.open||"2"==e.addForm.open,clearable:""},model:{value:e.addForm.roleInfos,callback:function(t){e.$set(e.addForm,"roleInfos",t)},expression:"addForm.roleInfos"}},e._l(e.roleOptions,(function(e){return t("el-option",{key:e.id.toString(),attrs:{label:e.roleName,value:e.id.toString()}})})),1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"描述"}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.addForm.description,callback:function(t){e.$set(e.addForm,"description",t)},expression:"addForm.description"}})],1)],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.addSubmit}},[e._v("确 定")]),t("el-button",{on:{click:e.addCancel}},[e._v("取 消")])],1)],1),t("div",{staticClass:"role-manage",style:"right:"+e.roleTabShow+"px"},[t("div",{staticClass:"close-btn",on:{click:function(t){e.roleTabShow="-350"}}}),t("ul",e._l(e.roleOptions,(function(i,s){return t("li",{key:i.id.toString(),staticClass:"role-li",staticStyle:{position:"relative"},on:{click:function(t){return e.editRoleFun(t,i)},mousedown:function(t){return e.createRipple(t,this)},mouseup:function(t){return e.removeRipple(t,this)}}},[t("div",{class:["left-div","leftIn",{active:s%7==0,active1:s%7==1,active2:s%7==2,active3:s%7==3,active4:s%7==4,active5:s%7==5,active6:s%7==6,active7:s%7==7}]},[t("span")]),t("div",{staticClass:"font"},[e._v(e._s(i.roleName))])])})),0)]),t("el-dialog",{attrs:{title:e.title,visible:e.editRole,width:"600px","append-to-body":""},on:{"update:visible":function(t){e.editRole=t}}},[t("div",{staticStyle:{display:"flex"}},[t("div",{staticClass:"search-input search-margin"},[t("div",{staticClass:"search-name"},[e._v("权限名称：")]),t("el-input",{attrs:{placeholder:"请输入权限名称搜索",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchInputFun2.apply(null,arguments)}},model:{value:e.qxName2,callback:function(t){e.qxName2=t},expression:"qxName2"}})],1),t("div",{staticClass:"search-input search-margin"},[t("div",{staticClass:"search-name"},[e._v("URL路径：")]),t("el-input",{attrs:{placeholder:"请输入URL路径搜索",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchInputFun2.apply(null,arguments)}},model:{value:e.qxUrl2,callback:function(t){e.qxUrl2=t},expression:"qxUrl2"}})],1),t("div",{staticClass:"search-btn-input",on:{click:e.searchInputFun2}},[t("i",{staticClass:"el-icon-search"})])]),t("ul",{staticClass:"role-ul"},e._l(e.tableData2,(function(i){return t("li",{directives:[{name:"show",rawName:"v-show",value:0==i.open,expression:"item.open == 0"}],key:i.id.toString(),class:{active:-1!=e.editRoleForm.permissionInfos.indexOf(i.id.toString())},staticStyle:{position:"relative"},on:{click:function(t){return e.changeRolePermiss(i)},mousedown:function(t){return e.createRipple(t,this)},mouseup:function(t){return e.removeRipple(t,this)}}},[t("span",{staticClass:"span-img"}),t("div",{staticClass:"font-desc"},[t("div",{staticClass:"font-desc-name"},[e._v(e._s(i.urlName))]),t("div",{staticClass:"font-desc-url"},[e._v(e._s(i.url))])])])})),0),t("div",{staticClass:"mini-pagination"},[t("el-pagination",{attrs:{"current-page":e.pageNum2,background:"","page-size":e.pageSize2,layout:"total, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange2,"current-change":e.handleCurrentChange2,"update:currentPage":function(t){e.pageNum2=t},"update:current-page":function(t){e.pageNum2=t}}})],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{staticStyle:{background:"#506ea1"},attrs:{type:"primary"},on:{click:e.editRoleSubmit}},[e._v("确 定")]),t("el-button",{on:{click:e.beforeClose}},[e._v("取 消")])],1)])],1)},a=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"logo-div"},[t("div",{staticClass:"logo-font animated flip"},[e._v("网关鉴权平台")]),t("div",{staticClass:"bottom-line line-left"})])}],l=(i("14d9"),{components:{},data(){return{roleTabShow:"-350",jsId:"",file:null,questionObject:{file:null},questionIds:[],formLabelWidth:"120px",fileList:[{name:void 0}],templateShow:!1,username:"",tel:"",dataStatus:"",pageSize:10,pageNum:0,pageSize2:10,pageNum2:0,total:0,time:["",""],tableData:[{urlName:"123"},{urlName:"123"},{urlName:"123"}],tableData2:[],multipleSelection:[],switchStatus:"0",currentPage:5,add:!1,addrules:{urlName:[{required:!0,message:"权限名称不能为空",trigger:"blur"}],url:[{required:!0,message:"URL路径不能为空",trigger:"blur"}]},addForm:{urlName:"",url:"",open:"0",description:"",roleInfos:[]},title:"",deptOptions:void 0,statusOptions:[],postOptions:[],roleOptions:[],edit:!1,editrules:{urlName:[{required:!0,message:"权限名称不能为空",trigger:"blur"}],url:[{required:!0,message:"URL路径不能为空",trigger:"blur"}]},editForm:{urlName:"",url:"",open:"0",description:"",roleInfos:[],id:""},editRoleForm:{permissionInfos:[]},resetFlag:!1,resetForm:{password:""},editRole:!1,activeRole:{},dictOptions:[],qxName:"",qxUrl:"",qxName2:"",qxUrl2:""}},mounted(){this.searchFn(),this.searchFn2(),this.getRoles(),this.queryDictByDictTypeId()},methods:{handleClose(){this.$refs["form"].resetFields(),this.add=!1},handleSelectionChange(e){this.multipleSelection=e},handleRowClick(e){this.$refs.multipleTable.toggleRowSelection(e);const t=this.$refs.multipleTable.selection;console.log("当前选中的数据",t),this.handleSelectionChange(t)},beforeClose(){this.editRole=!1,this.pageNum2=1,this.qxName2="",this.qxUrl2="",this.searchFn2()},changeRolePermiss(e){-1==this.editRoleForm.permissionInfos.indexOf(e.id.toString())?this.editRoleForm.permissionInfos.push(e.id.toString()):this.editRoleForm.permissionInfos.splice(this.editRoleForm.permissionInfos.indexOf(e.id.toString()),1)},logout(){this.$post($url.DATA_URL+"/logout").then(e=>{200==e.data.code?this.$router.push("/"):this.$message({type:"error",message:e.data.msg})})},queryDictByDictTypeId(){this.$get($url.DATA_URL+"/gateway/queryDictByDictTypeId?dictTypeId=1").then(e=>{200==e.data.code?this.dictOptions=e.data.data:this.$router.push("/")})},queryPermissionByRoleId(){this.$get($url.DATA_URL+"/gateway/queryPermissionsByRoleId?roleId="+this.activeRole.id).then(e=>{if(200==e.data.code){this.editRoleForm.permissionInfos=[];for(let t=0;t<e.data.data.length;t++)this.editRoleForm.permissionInfos.push(e.data.data[t].id.toString())}else this.$message({type:"error",message:e.data.msg})})},editRoleFun(e,t){this.activeRole=t,this.editRole=!0,this.queryPermissionByRoleId()},handleSelectionChange(e){this.multipleSelection=e},handleEdit(e,t){this.title="修改权限",this.add=!0,this.addForm.urlName=t.urlName,this.addForm.open=t.open.toString(),this.addForm.url=t.url,this.addForm.description=t.description,this.addForm.roleInfos=[];for(let i=0;i<t.roleInfos.length;i++)this.addForm.roleInfos.push(t.roleInfos[i].id);this.addForm.id=t.id},handleSizeChange(e){this.pageSize=e,this.searchFn()},handleCurrentChange(e){this.pageNum=e,this.searchFn()},handleSizeChange2(e){this.pageSize2=e,this.searchFn2()},handleCurrentChange2(e){this.pageNum2=e,this.searchFn2()},handleSelectChange(){},addDialog(){this.addForm={urlName:"",url:"",open:"0",description:"",roleInfos:[]},this.title="新增权限",this.add=!0},getRoles(){this.$get($url.DATA_URL+"/gateway/queryAllRoles").then(e=>{200==e.data.code?this.roleOptions=e.data.data:this.$router.push("/login")})},addSubmit(){let e="/gateway/addPermission";this.addForm.id&&(e="/gateway/updatePermission"),this.$refs["form"].validate(t=>{if(t){if("0"==this.addForm.open&&0==this.addForm.roleInfos.length)return void this.$message.warning("请选择角色!");let t=[];for(let e=0;e<this.roleOptions.length;e++)-1!=this.addForm.roleInfos.indexOf(this.roleOptions[e].id)&&t.push(this.roleOptions[e]);this.addForm.roleInfos=t,this.$post($url.DATA_URL+e,this.addForm).then(e=>{200==e.data.code?(this.add=!1,this.$message({type:"success",message:e.data.msg}),this.searchFn()):this.$message({type:"error",message:e.data.msg})})}else this.add=!0})},addCancel(){this.$refs["form"].resetFields(),this.add=!1},editDialog(){if(console.log(this.multipleSelection,"editDialog.multipleSelection"),this.editForm={urlName:"",url:"",open:"1",description:"",roleInfos:[],id:""},this.multipleSelection.length>1||this.multipleSelection.length<1)return this.$message({type:"error",message:"请选择一条权限信息"});this.title="修改权限",this.edit=!0,this.editForm.urlName=row.urlName,this.editForm.open=row.open.toString(),this.editForm.url=row.url,this.editForm.description=row.description,this.editForm.roleInfos=row.roleInfos,this.editForm.id=row.id},editSubmit(){let e={urlName:this.editForm.urlName,open:this.editForm.open,url:this.editForm.url,description:this.editForm.description,roleInfos:this.editForm.roleInfos,id:this.editForm.id},t=[];for(let i=0;i<this.roleOptions.length;i++)-1!=e.roleInfos.indexOf(this.roleOptions[i].id)&&t.push(this.roleOptions[i]);e.roleInfos=t,this.$post($url.DATA_URL+"/gateway/updatePermission",e).then(e=>{200==e.data.code?(this.$message({type:"success",message:e.data.msg}),this.searchFn()):this.$message({type:"error",message:e.data.msg})}),this.edit=!1},editRoleSubmit(){let e={permissionInfos:[],id:this.activeRole.id};for(let t=0;t<this.editRoleForm.permissionInfos.length;t++)e.permissionInfos.push({id:this.editRoleForm.permissionInfos[t]});this.$post($url.DATA_URL+"/gateway/bindPermissionByRole",e).then(e=>{200==e.data.code?(this.$message({type:"success",message:e.data.msg}),this.searchFn()):this.$message({type:"error",message:e.data.msg})}),this.editRole=!1,this.pageNum2=1,this.handleSizeChange2(),this.activeRole={}},editCancel(){this.edit=!1},handleDel(e,t){this.$confirm("此操作将永久删除该条权限信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$get($url.DATA_URL+"/gateway/delPermission?id="+t.id).then(e=>{200==e.data.code?(this.$message({type:"success",message:"删除成功!"}),this.searchFn()):this.$message({type:"error",message:e.data.msg})})})},delDialog(){if(this.multipleSelection.length<1)return this.$message({type:"error",message:"请至少选择一条数据"});let e=this;this.$confirm("此操作将永久删除数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let t="";for(let i=0;i<e.multipleSelection.length;i++)t+=e.multipleSelection[i].id.toString()+",";this.$get($url.DATA_URL+"/gateway/delPermissions?ids="+t).then(e=>{200==e.data.code?(this.$message({type:"success",message:"删除成功!"}),this.searchFn()):this.$message({type:"error",message:e.data.msg})})})},uploadFn(){this.templateShow=!0},uploadChange(e){this.questionObject.file=e.raw},uploadRemove(){this.file=null},formatter(e){let t=e.split("&"),i="";for(let s in t)i+=encodeURIComponent(t[s].split("=")[0])+"=",i+=encodeURIComponent(t[s].split("=")[1])+"&";return i},searchInputFun(){this.pageNum=1,this.searchFn()},searchInputFun2(){this.pageNum2=1,this.searchFn2()},searchFn(){this.cookie.getCookie("username")||this.$router.push("/login");let e={urlName:this.qxName,url:this.qxUrl,permissionInfoPage:{current:this.pageNum,size:this.pageSize}};this.$post($url.DATA_URL+"/gateway/queryPermission",e).then(e=>{200===e.data.code?(this.tableData=e.data.data.details,this.total=e.data.data.total):(this.$message({type:"error",message:e.data.msg}),this.$router.push("/login"))})},searchFn2(){this.cookie.getCookie("username")||this.$router.push("/login");let e={urlName:this.qxName2,url:this.qxUrl2,permissionInfoPage:{current:this.pageNum2,size:this.pageSize2}};this.$post($url.DATA_URL+"/gateway/queryPermission",e).then(e=>{200===e.data.code?(this.tableData2=e.data.data.details,this.total=e.data.data.total):this.$router.push("/login")})},resetFn(){this.username="",this.tel="",this.dataStatus="",this.time=[],this.searchFn()},computeRippleStyles(e,t){const{top:i,left:s}=e.getBoundingClientRect(),{clientWidth:a,clientHeight:l}=e,o=Math.sqrt(a**2+l**2)/2,n=2*o,r=t.clientX-s,d=t.clientY-i,c=(a-2*o)/2,u=(l-2*o)/2,p=r-o,h=d-o;return{x:p,y:h,centerX:c,centerY:u,size:n}},createRipple(e){const t=e.currentTarget,{x:i,y:s,centerX:a,centerY:l,size:o}=this.computeRippleStyles(t,e),n=document.createElement("div");n.classList.add("myripple"),n.style.opacity="0",n.style.transform=`translate(${i}px, ${s}px) scale3d(.3, .3, .3)`,n.style.width=o+"px",n.style.height=o+"px",n.style.position="absolute",n.style.top="0",n.style.left="0",n.style["z-index"]="100",n.style["border-radius"]="50%",n.style["background-color"]="#fad4a1",n.style["opacity"]="0",n.style.transition="transform 0.2s cubic-bezier(0.68, 0.01, 0.62, 0.6),opacity 0.08s linear",n.style["will-change"]="transform, opacity",n.style["pointer-events"]="none",n.dataset.createdAt=String(performance.now());const{position:r}=window.getComputedStyle(t);t.style.overflow="hidden","static"===r&&(this.style.position="relative"),t.appendChild(n),window.setTimeout(()=>{n.style.transform=`translate(${a}px, ${l}px) scale3d(1, 1, 1)`,n.style.opacity=".25"})},removeRipple(e){const t=e.currentTarget,i=t.querySelectorAll(".myripple");if(!i.length)return;const s=i[i.length-1],a=300-performance.now()+Number(s.dataset.createdAt);setTimeout(()=>{s.style.opacity="0",setTimeout(()=>{var e;return null===(e=s.parentNode)||void 0===e?void 0:e.removeChild(s)},300)},a)}}}),o=l,n=(i("7203"),i("b222"),i("2877")),r=Object(n["a"])(o,s,a,!1,null,"272b32fe",null);t["default"]=r.exports},b222:function(e,t,i){"use strict";i("21c5")},bc2e:function(e,t,i){}}]);
//# sourceMappingURL=chunk-2d18f0c4.83018e76.js.map